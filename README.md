# Pentesting-Research-Assignments
Time spent: **10** hours spent in total

> Objective: Find, analyze, recreate, and document **five vulnerabilities** affecting an old version of WordPress

## Pentesting Report

1. (Required) WordPress <= 4.2.2 - Authenticated Stored Cross-Site Scripting (XSS)
- [ ] Summary:  A stored XSS vulnerability that allows a user with the posting capability to compromise the website. The attacker can insert HTML containing JavaScript on a WordPress page or post. The malicious script will be excuted when an admin views the page and then will proceed to the server-side. 
- Vulnerability types: XSS
- Tested in version: 4.2
- Fixed in version: 4.2.3
- [ ] GIF Walkthrough: <img src="gifs/PostStoredXSS.gif" width="800">
- [ ] Steps to recreate: Go to post/page posting and change to HTML edit mode. In which create a hyperlink tag in which the XSS attack is inside of. When the person goes to the posting the XSS is activated. 
- [ ] Affected source code: The post function that looks at the HTML
- [Link 1](https://klikki.fi/adv/wordpress3.html)
1. (Required) WordPress 2.5-4.6 - Authenticated Stored Cross-Site Scripting via Image Filename
- [ ] Summary: A Cross-Site Scripting (XSS) vulnerability. In which a attacker can create a image file name that when uploaded in WordPress, injects malicious JavaScript code into the application. An attacker can use this to steal session tokens, login credentials or performing arbirtary actions.
- Tested in version: 4.2
- Fixed in version: 4.6.1
- [ ] GIF Walkthrough: <img src="gifs/FileUploadXSS.gif" width="800">
- [ ] Steps to recreate: Need to name a file with a XSS attack. Then upload the file. When the file is viewed in its own webpage the XSS attack will activate. 
- [ ] Affected source code: The file name of an image is used as image Title (meta) in so called ‘attachment pages’ (HTML). An attacker can exploit this vulnerability by crafting an image file name with Cross-Site Scripting payload 
- [Link 1](https://sumofpwn.nl/advisory/2016/persistent_cross_site_scripting_vulnerability_in_wordpress_due_to_unsafe_processing_of_file_names.html)
1. (Required) Title: WordPress  4.0-4.7.2 - Authenticated Stored Cross-Site Scripting (XSS) in YouTube URL Embeds
- [ ] Summary: An attacker can put a stored XSS in a embeded youtube link which will pass through the function and will post the link and do the XSS attack as well when the post is opened.
- Vulnerability types: XSS
- Tested in version: 4.2
- Fixed in version: 4.7.3
- [ ] GIF Walkthrough: <img src="gifs/YoutubeLinkXSS.gif" width="800">
- [ ] Steps to recreate: Need to embed the XSS in a youtube link that has some of the special characters that will make the function miss it. Then put that link in a post and post it. 
- [ ] Affected source code: shortcode_parse_atts function
- [Link 1](https://blog.sucuri.net/2017/03/stored-xss-in-wordpress-core.html)
1. (Optional) Vulnerability Name or ID
- [ ] Summary: 
- Vulnerability types:
- Tested in version:
- Fixed in version: 
- [ ] GIF Walkthrough: 
- [ ] Steps to recreate: 
- [ ] Affected source code:
- [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php)
1. (Optional) Vulnerability Name or ID
- [ ] Summary: 
- Vulnerability types:
- Tested in version:
- Fixed in version: 
- [ ] GIF Walkthrough: 
- [ ] Steps to recreate: 
- [ ] Affected source code:
- [Link 1](https://core.trac.wordpress.org/browser/tags/version/src/source_file.php) 

## Assets

None

## Resources

- [WordPress Source Browser](https://core.trac.wordpress.org/browser/)
- [WordPress Developer Reference](https://developer.wordpress.org/reference/)

GIFs created with [LiceCap](http://www.cockos.com/licecap/).

## Notes

The most challenging part was finding attacks that had a blog that will talk about how the attack actually worked. All the websites that were listed would just talk about the attack in general terms or just about the updates that were created in order to stop it, which at first was confusing trying to figure out the actual attack. Sometimes links wouldn't go through in the Kali system which made it a little annoying. i feel most of my time was used going thorugh all the websites trying to figure out which attacks had a good description. Once an attack ws found with a website talking about it and explaining it, it was easy to follow through to recreate it. 

## License

Copyright [yyyy] [name of copyright owner]

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
